function badgeos_add_new_rank_req_step(e){jQuery.post(ajaxurl,{action:"add_rank_req_step",achievement_id:e},function(e){jQuery(e).appendTo("#ranks_steps_list"),new_step_menu_order=Number(jQuery("#ranks_steps_list li.step-row").eq(-2).children('input[name="order"]').val())+1,jQuery("#ranks_steps_list li.step-row:last").children('input[name="order"]').val(new_step_menu_order),jQuery("#ranks_steps_list li.step-row:last").children(".select-trigger-type").change()})}function badgeos_delete_rank_req_step(e){jQuery.post(ajaxurl,{action:"delete_rank_req_step",step_id:e},function(s){jQuery(".step-"+e).remove()})}function badgeos_update_rank_steps(e){jQuery(".save-ranks-steps-spinner").show(),step_data={action:"update_ranks_req_steps",steps:[]};var s=0;jQuery("#ranks_steps_list .step-row").each(function(){var e=jQuery(this),t=e.find(".select-trigger-type").val(),i=e.find(".badgeos-select-visit-post").val(),a=e.find(".badgeos-select-visit-page").val(),n=e.find("#badgeos_achievements_step_dynamic_section_"+t+" .badgeos_achievements_step_ddl_dynamic").val(),_=e.find("#badgeos_achievements_step_dynamic_section_"+t+" .badgeos_achievements_step_ddl_dynamic").attr("id"),r=e.find(".badgeos_achievements_step_fields_"+n+":input").serialize(),d={step_id:e.attr("data-step-id"),order:e.find('input[name="order"]').val(),required_count:e.find(".required-count").val(),trigger_type:t,badgeos_subtrigger_id:_,badgeos_subtrigger_value:n,visit_post:i,visit_page:a,badgeos_fields_data:r,num_of_years:e.find(".badgeos-num-of-years").val(),achievement_post:"badgeos_specific_new_comment"===t?e.find("input.select-achievement-post").val():e.find("select.select-achievement-post").val(),title:e.find(".step-title .title").val()};e.trigger("update_step_data",[d,e]),step_data.steps.push(d),s++}),0==s&&jQuery(".save-ranks-steps-spinner").hide(),jQuery.post(ajaxurl,step_data,function(e){var s=jQuery.parseJSON(e);jQuery.each(s,function(e,s){jQuery("#step-"+e+"-title").val(s)}),jQuery(".save-ranks-steps-spinner").hide()})}jQuery(document).ready(function(e){function s(){"Yes"==e(".cmb2-id--ranks-unlock-with-points input[type=radio]:checked").val()?e(".cmb2-id--ranks-points-to-unlock").css("display","block"):e(".cmb2-id--ranks-points-to-unlock").css("display","none")}e(".cmb2-id--ranks-unlock-with-points input[type=radio]").on("click",function(){s()}),e("#ranks_steps_list").sortable({update:function(){e("#ranks_steps_list li").each(function(s,t){e(this).children('input[name="order"]').val(s)})}}),e("#ranks_steps_list").on("change",".select-trigger-type",function(){var s=e(this).val(),t=e(this).siblings(".select-achievement-post"),i=e(this).siblings(".badgeos-select-visit-post"),a=e(this).siblings(".badgeos-select-visit-page"),n=e(this).siblings(".badgeos-num-of-years");"badgeos_specific_new_comment"==s?t.show():t.hide(),"badgeos_on_completing_num_of_year"==s?n.show():n.hide(),"badgeos_visit_a_page"==s||"badgeos_award_author_on_visit_page"==s?a.show():a.hide(),"badgeos_visit_a_post"==s||"badgeos_award_author_on_visit_post"==s?i.show():i.hide(),e(".badgeos_achievements_step_fields").hide(),e(".badgeos_achievements_step_ddl_dynamic").hide(),e("#badgeos_achievements_step_ddl_dynamic_"+s).show().trigger("change"),t.change()}),e(".badgeos_achievements_step_ddl_dynamic").on("change",function(){e(".badgeos_achievements_step_subddl_dynamic").hide(),e(".badgeos_achievements_step_subtxt_dynamic").hide(),main_trigger=e(this).data("trigger"),curr_trigger=e(this).val(),e(".badgeos_achievements_step_subddl_"+curr_trigger).show(),e(".badgeos_achievements_step_subtxt_"+curr_trigger).show()}),e(".select-trigger-type").change(),s()});