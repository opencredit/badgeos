function badgeos_add_new_step(e){jQuery.post(ajaxurl,{action:"add_step",achievement_id:e},function(e){jQuery(e).appendTo("#steps_list"),new_step_menu_order=Number(jQuery("#steps_list li.step-row").eq(-2).children('input[name="order"]').val())+1,jQuery("#steps_list li.step-row:last").children('input[name="order"]').val(new_step_menu_order),jQuery("#steps_list li.step-row:last").children(".select-trigger-type").change()})}function badgeos_delete_step(e){jQuery.post(ajaxurl,{action:"delete_step",step_id:e},function(s){jQuery(".step-"+e).remove()})}function badgeos_update_steps(e){jQuery(".save-steps-spinner").show(),step_data={action:"update_steps",steps:[]};var s=0;jQuery(".step-row").each(function(){var e=jQuery(this),t=e.find(".select-trigger-type").val(),i=e.find("#badgeos_achievements_step_dynamic_section_"+t+" .badgeos_achievements_step_ddl_dynamic").val(),a=e.find("#badgeos_achievements_step_dynamic_section_"+t+" .badgeos_achievements_step_ddl_dynamic").attr("id"),n=e.find(".badgeos_achievements_step_fields_"+i+":input").serialize(),_=e.find(".badgeos-select-visit-post").val(),d=e.find(".badgeos-select-visit-page").val(),o={step_id:e.attr("data-step-id"),order:e.find('input[name="order"]').val(),required_count:e.find(".required-count").val(),trigger_type:t,achievement_type:e.find(".select-achievement-type").val(),num_of_years:e.find(".badgeos-num-of-years").val(),num_of_days:e.find(".badgeos-num-of-days").val(),badgeos_subtrigger_id:a,visit_post:_,visit_page:d,badgeos_subtrigger_value:i,badgeos_fields_data:n,achievement_post:"badgeos_specific_new_comment"===t?e.find("input.select-achievement-post").val():e.find("select.select-achievement-post").val(),title:e.find(".step-title .title").val()};e.trigger("update_step_data",[o,e]),step_data.steps.push(o),s++}),0==s&&jQuery(".save-steps-spinner").hide(),jQuery.post(ajaxurl,step_data,function(e){var s=jQuery.parseJSON(e);jQuery.each(s,function(e,s){jQuery("#step-"+e+"-title").val(s)}),jQuery(".save-steps-spinner").hide()})}jQuery(document).ready(function(e){e("#_badgeos_earned_by").change(function(){"triggers"==e(this).val()?e("#badgeos_steps_ui").show():e("#badgeos_steps_ui").hide()}).change(),e("#steps_list").sortable({update:function(){e("#steps_list li").each(function(s,t){e(this).children('input[name="order"]').val(s)})}}),e("#steps_list").on("change",".select-trigger-type",function(){var s=e(this).val(),t=e(this).siblings(".select-achievement-type"),i=e(this).siblings(".badgeos-select-visit-post"),a=e(this).siblings(".badgeos-select-visit-page"),n=e(this).siblings(".badgeos-num-of-years"),_=e(this).siblings(".badgeos-num-of-days");"any-achievement"==s||"all-achievements"==s||"specific-achievement"==s?t.show():t.hide(),"badgeos_visit_a_page"==s||"badgeos_award_author_on_visit_page"==s?a.show():a.hide(),"badgeos_visit_a_post"==s||"badgeos_award_author_on_visit_post"==s?i.show():i.hide(),"badgeos_on_completing_num_of_year"==s?n.show():n.hide(),"badgeos_wp_not_login"==s?_.show():_.hide(),e(".badgeos_achievements_step_fields").hide(),e(".badgeos_achievements_step_ddl_dynamic").hide(),e("#badgeos_achievements_step_ddl_dynamic_"+s).show().trigger("change"),t.change()}),e(".badgeos_achievements_step_ddl_dynamic").on("change",function(){e(".badgeos_achievements_step_subddl_dynamic").hide(),e(".badgeos_achievements_step_subtxt_dynamic").hide(),main_trigger=e(this).data("trigger"),curr_trigger=e(this).val(),e(".badgeos_achievements_step_subddl_"+curr_trigger).show(),e(".badgeos_achievements_step_subtxt_"+curr_trigger).show()}),e(".select-trigger-type").change(),e("#steps_list").on("change",".select-achievement-type",function(){var s=e(this),t=s.val(),i=s.parent("li").attr("data-step-id"),a=[s.siblings('input[name="post_id"]').val()],n=s.siblings(".select-trigger-type").val();s.siblings("select.select-achievement-post").hide(),s.siblings("input.select-achievement-post").hide(),""!==t&&"specific-achievement"==n?e.post(ajaxurl,{action:"post_select_ajax",achievement_type:t,step_id:i,excluded_posts:a},function(e){s.siblings("select.select-achievement-post").html(e),s.siblings("select.select-achievement-post").show()}):(s.siblings(".select-achievement-post").hide(),"badgeos_specific_new_comment"==n&&s.siblings("input.select-achievement-post").show())}),e(".select-achievement-type").change()});