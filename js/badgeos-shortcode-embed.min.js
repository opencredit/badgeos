(function($){function badgeos_set_current_attributes(shortcode){var result={},attrs=[];attrs=badgeos_get_text_inputs(attrs,shortcode);attrs=badgeos_get_select_inputs(attrs,shortcode);attrs=badgeos_get_select2_inputs(attrs,shortcode);result.shortcode=shortcode;result.params=attrs;return result}function badgeos_get_text_inputs(attrs,shortcode){var inputs=$('#shortcode_options input[type="text"]');$.each(inputs,function(index,el){if(el.className===shortcode&&el.value!=="")attrs.push(el.name+'="'+el.value+
'"')});return attrs}function badgeos_get_select_inputs(attrs,shortcode){var selects=$("#shortcode_options select option:selected");$.each(selects,function(index,el){var $parent=$(this).parent();if($parent.attr("class")===shortcode)attrs.push($parent.attr("name")+'="'+el.text+'"')});return attrs}function badgeos_get_select2_inputs(attrs,shortcode){var inputs=$("#"+shortcode+"_wrapper .select2-container");$.each(inputs,function(index,el){var val=$(el).select2("val");var theattr=$(el).prop("id");var trimmed=
badgeos_select2_trim_id(theattr,shortcode);if(val.length>0&&val!=="")attrs.push(trimmed+'="'+val+'"')});return attrs}function badgeos_select2_trim_id(input,shortcode){if(shortcode==="badgeos_achievements_list")return input.replace("s2id_badgeos_achievements_list_","");else if(shortcode==="badgeos_achievement")return input.replace("s2id_badgeos_achievement_","");else if(shortcode==="badgeos_nomination")return input.replace("s2id_badgeos_nomination_","");else if(shortcode==="badgeos_submission")return input.replace("s2id_badgeos_submission_",
"");else if(shortcode==="badgeos_submissions")return input.replace("s2id_badgeos_submissions_achievement_","");else if(shortcode==="badgeos_nominations")return input.replace("s2id_badgeos_nominations_achievement_","")}function badgeos_insert_shortcode(){var shortcode,requested;shortcode=$("#select_shortcode option:selected").val();requested=badgeos_set_current_attributes(shortcode);window.send_to_editor(badgeos_construct_shortcode(requested))}function badgeos_construct_shortcode(requested){var shortcode=
"[";shortcode+=requested.shortcode;if(requested.params){for(i=0;i<requested.params.length;i++)shortcode+=" "+requested.params[i];$.trim(shortcode)}shortcode+="]";return shortcode}function s2formatResult_users(item){return item.user_login}function s2formatSelection_users(item){return item.user_login}function s2formatResult_posts(item){return item.post_title}function s2formatSelection_posts(item){return item.post_title}function s2formatResult_posttypes(item){return item.label}function s2formatSelection_posttypes(item){return item.label}
$("#select_shortcode").on("change",function(){var selected=$("#select_shortcode option:selected").val();$(".badgeos_input").parent().hide();$("."+selected).parent().parent().show()});$("#badgeos_insert").on("click",function(e){badgeos_insert_shortcode()});$("#badgeos_cancel").on("click",function(e){e.preventDefault();tb_remove()});$("#insert_badgeos_shortcodes").on("click",function(e){var inputs=$(".select2-container");$.each(inputs,function(index,el){$(el).select2("val","")})});$("#badgeos_achievements_list_user_id").select2({ajax:{url:ajaxurl,
type:"POST",data:function(term){return{q:term,action:"get-users"}},results:function(data,page){return{results:data.data}}},id:function(object){return object.ID},allowClear:true,placeholder:badgeos_shortcode_embed_messages.id_placeholder,formatResult:s2formatResult_users,formatSelection:s2formatSelection_users});$("#badgeos_achievement_id,#badgeos_nomination_achievement_id,#badgeos_submission_achievement_id").select2({ajax:{url:ajaxurl,type:"POST",data:function(term){return{q:term,action:"get-posts"}},
results:function(data,page){return{results:data.data}}},id:function(object){return object.ID},allowClear:true,placeholder:badgeos_shortcode_embed_messages.id_placeholder,formatResult:s2formatResult_posts,formatSelection:s2formatSelection_posts});$("#badgeos_achievements_list_include,#badgeos_achievements_list_exclude").select2({ajax:{url:ajaxurl,type:"POST",data:function(term){return{q:term,action:"get-posts",post_type:$("#badgeos_achievements_list_type").val()}},results:function(data,page){return{results:data.data}}},
id:function(object){return object.ID},allowClear:true,placeholder:badgeos_shortcode_embed_messages.id_placeholder,multiple:true,formatResult:s2formatResult_posts,formatSelection:s2formatSelection_posts});$("#badgeos_achievements_list_type,#badgeos_nominations_achievement_type,#badgeos_submissions_achievement_type").select2({ajax:{url:ajaxurl,type:"POST",data:function(term){return{q:term,action:"get-achievement-types"}},results:function(data,page){return{results:data.data}}},id:function(object){return object.name},
allowClear:true,placeholder:badgeos_shortcode_embed_messages.post_type_placeholder,multiple:true,formatResult:s2formatResult_posttypes,formatSelection:s2formatSelection_posttypes})})(jQuery);
